<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" rel="stylesheet">


<!-- Font Awesome 6 Free (Latest) -->
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

<th:block th:include="fragments/headerlibs.html :: headerlibs"></th:block>

<body id="page-top" onload="getVoucherTransactionList(),
erupiVoucherCreateListLimit(),getLinkedBankDetail(),getBankListWithVocher(),
requestedVoucherCount()">
	<!--onload="getIssueVoucherList(), getLinkedBankDetail(),getBankListWithVocher(),requestedVoucherCount()"-->

    <div class="bs-canvas-overlay bg-dark position-fixed w-100 h-100"></div>

    <!-- Page Wrapper -->
    <div id="wrapper">

		<!-- Sidebar -->
				      
 	   <div th:insert="fragments/sidenav.html :: sidevav"></div>
       <!-- End of Sidebar -->

        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">

            <!-- Main Content -->
            <div id="content">

				<!-- Topbar -->
				              

<nav class="navbar navbar-expand navbar-light bg-white topbar static-top">

                   <!-- Topbar Navbar -->
                   <ul class="navbar-nav top-nav">

                       <!-- Nav Item - User Information -->
                     <!--  <li class="nav-item">
                           <a class="nav-link active" href="#">
                               <span class="mr-2 small">Dashboard</span>
                               <i class="fas fa-ellipsis-v fa-sm fa-fw"></i>
                           </a>
                       </li>
                       <li class="nav-item">
                           <a class="nav-link" href="#">
                               <span class="mr-2 small">Employee Payroll</span>
                               <i class="fas fa-ellipsis-v fa-sm fa-fw"></i>
                           </a>
                       </li>-->

                   </ul>

				   <!-- Right Icons + Profile -->
				   			    <ul class="navbar-nav d-flex flex-row align-items-center mb-0">
				   			      <!-- Wallet Icon -->
				   			     <!-- <li class="nav-item mr-3">
				   			        <a href="/settings/wallet" role="button">
				   			          <img src="img/Wallet-icon.png" alt="Wallet" class="nav-icon-img" >
				   			        </a>
				   			      </li>-->
				   				  <li class="nav-item mr-3">
				     			        <a href="/cotowallet" role="button">
				     			          <img src="img/Wallet-icon.png" alt="Wallet" class="nav-icon-img" >
				     			        </a>
				     			      </li>
				   			      <!-- Notification Icon -->
				   			      <li class="nav-item mr-3">
				   			        <a href="#" role="button">
				   			          <img src="img/Notification-icon.png" alt="Notification" class="nav-icon-img">
				   			        </a>
				   			      </li>

				   			      <!-- Profile Dropdown -->
				   			      <li class="nav-item dropdown no-arrow">
				   			        <a class="nav-link dropdown-toggle p-0" href="#" id="userDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
				   			          <img class="img-profile rounded-circle" src="img/undraw_profile.svg" alt="User" style="width: 32px; height: 32px;">
				   			        </a>
				   			        <div class="dropdown-menu dropdown-menu-right shadow animated--grow-in" aria-labelledby="userDropdown">
				   			          <a class="logout-profile" href="/ProfileInfo">
				   			            <i class="fas fa-user fa-sm fa-fw mr-2 text-gray-400"></i> Profile
				   			          </a>
				   			       <!--   <a class="dropdown-item" href="#">
				   			            <i class="fas fa-cogs fa-sm fa-fw mr-2 text-gray-400"></i> Settings
				   			          </a>-->
									  <div class="dropdown-divider"></div>
  				   			          <a class="logout-profile" th:href="@{/logout}">
  				   			            <i class="fas fa-sign-out-alt fa-sm fa-fw mr-2 text-gray-400"></i> Logout
  				   			          </a>
																					  
				   			        </div>
				   			      </li>
				   			    </ul>		
           </nav>
  <!-- End of Topbar -->

                <!-- Begin Page Content -->
                <div class="container-fluid p-0 p-md-1">
                    <div class="row">
                        <div class="col-12">
                            <div class="tab-content">
                                <div class="upi-voucher-wrap">
                                    <div class="d-block">
                                        <h3>UPI Voucher Issuance</h3>
                                    </div>

                                    <div class="row">
                                        <div class="col-12 col-md-3">
                                            <button class="btn-border-custom" id="requestedVoucher">
                                                <a href="#">
													<div style="position: relative; display: inline-block;">
													    <i class="bi bi-bell" style="font-size: 1.2rem;"></i>
													    <span id="bellCountBadge"
													          style="position: absolute; top: -5px; right: -5px; background: red; color:  white;
													                 font-size: 11px; padding: 2px 6px; border-radius: 50%; display: none;">
													        0
													    </span>
													</div>
													<span>Vouchers Requested</span>
													
                                                    <div>
                                                        <strong>-</strong>
                                                        <img src="img/arrow-voucher.svg" alt="">
                                                    </div>
                                                </a>
                                            </button>
                                        </div>
                                        <!--<div class="col-12 col-md-3">
                                            <button class="btn-border-custom">
                                                <a href="#">
                                                    <div>
                                                        <img src="img/calendar-voucher.svg" alt="">
                                                        <span>Vouchers Scheduled</span>
                                                    </div>
                                                    <div>
                                                        <strong>-</strong>
                                                        <img src="img/arrow-voucher.svg" alt="">
                                                    </div>
                                                </a>
                                            </button>
                                        </div>-->

                                        <div class="col-12 col-md-3">
											<button class="btn-voucher-custom" id="issueManually" disabled>
											    <div><a href="#">
											        <img src="img/add-voucher.svg" alt="">
											        <span>Issue Manually</span>
													</a>
											    </div>
											</button>
                                        </div>
                                        <div class="col-12 col-md-3">
                                            <button class="btn-voucher-custom" id="issueBulk" disabled>
                                                <div><a href="#">
                                                        <img src="img/upload-voucher.svg" alt="">
                                                        <span>Issue with Bulk Upload</span>
														</a>
                                                </div>
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="upi-voucher-wrap mb-2">
                                    <div id="nolinkBankAccount" style="display: none;">
                                        <div class="d-flex align-items-center upi-voucher-in-wrap p-0 m-0">
                                            <div class="tip-wrap justify-content-start m-0">
                                                <p class="mb-0">No Bank Account linked till now. Please click on ‘Link
                                                    Bank
                                                    Account Now’ to activate UPI Voucher issuance.</p>
                                            </div>
                                            <a class="btn btn-primary" th:href="@{/roleAccess}" id="linkBankAccount">Link Bank Account
                                                Now</a>
                                        </div>
                                    </div>

                                    <div id="linkedAccount" style="display:none;">
                                        <div class="linkedAccount-wrap m-0">
                                            <div class="linkedAccount-wrap-left-btn">
                                                <img src="img/allbank.svg" alt="">
                                                <span>All Linked Bank Accounts</span>
                                            </div>
                                            <div class="linkedAccount-wrap-right">
                                                <span>Funds Marked for Active UPI Vouchers <img
                                                        src="img/e-rupi-seeklogo.png" alt=""></span>
                                                <div class="funds-mark"><div id="totalVoucher"></div>&nbsp; Vouchers &#8377;<strong id="totalvoucherValue">&#8377;0.00</strong></div>
												<div class="infoo mx-2"><a href="#" id="btnforinfomodal"><img
												 src="img/infoo.svg" width="34px" alt=""></a></div>
												 <!--<button class="fundmarked" >
												    <a href="#" id="fundmarked"><img src="img/fund-expand-green.svg" alt=""></a>
													 
												 </button>-->
												 <a href="#" id="fundmarked"><img src="img/fund-expand-green.svg" alt=""></a>
                                            </div>
                                        </div>

                                        <div class="activeupivcmarked" id="myDiv" style="display: none;">
                                            <div class="row">
                                                <div class="col-12 col-md-3" id="bankListData">
                                                    <div class="left-activeupivcmarked active">
                                                        <div class="img-bank">
                                                            <img src="img/allbankblk.svg" alt="">
                                                        </div>
                                                        <span>All Banks</span>

                                                    </div>

                                                   <!-- <div class="left-activeupivcmarked" >
                                                      
														<div class="img-bank">
		                                                      <img src="img/indianbank.png" width="18" height="18">
		                                                  </div>
		                                                  <span>Indian Bank</span>
		                                                  <label class="mb-0">xxx0569</label>
                                                    </div>-->
                                                </div>

                                                <div class="col-12 col-md-9">
                                                    <div class="table-responsive mt-2">
                                                        <table class="table table-bordered">
                                                            <thead>
                                                                <tr>
                                                                    <th>Total Vouchers Issued (A)</th>
                                                                    <th id="totalIssueCount"></th>
                                                                    <th id="totalIssueAmount"></th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr>
                                                                    <td>Redeemed Vouchers (B)</td>
                                                                    <td id="redemVCount"></td>
                                                                    <td id="redemVAmount"></td>
                                                                </tr>
                                                                <tr>
                                                                    <td>Expired & Revoked Vouchers (C)</td>
                                                                    <td id="expRevokeCount"></td>
                                                                    <td id="expRevokeAmount"></td>
                                                                </tr>
                                                                <tr class="lasttr">
                                                                    <td>Active Vouchers (D)</td>
                                                                    <td id="activeCount"></td>
                                                                    <td id="activeAmount"></td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="linkedAccount-wrap-p"><img src="img/recall.svg" alt="" class="mr-1">
									<label class="mb-0">Last updated on</label><span th:text="${session.formattedDate}" ></span></div>

									<input type="hidden" class="form-input" id="employerId" name="employerId" th:value="${session.id}">
									<input type="hidden" class="form-input" id="employerMobile" name="employerMobile" th:value="${session.mobile}">
									<input type="hidden" class="form-input" id="userRole" name="userRole" th:value="${session.user_role}">
        							<div class="upi-voucher-wrap">
									<div class="d-flex align-items-center justify-content-between">
									    <h3 class="mb-3">Details of UPI Vouchers & Transactions</h3>

									    <div class="rightdownload mb-3 d-flex align-items-center" style="gap: 12px;">
											<div id="clearFilters" style="font-size: 13px; color: #1F212C; cursor: pointer;">Clear Filters</div>
											    <!-- Search Box -->
											    <div style="width: 190px; height: 44px; border-radius: 10px; padding: 10px; border: 1px solid #EDEDF0;" class="d-flex align-items-center">
											        <img src="img/search.svg" alt="Search" style="margin-right: 6px;">
											        <input type="text" id="searchInput" placeholder="Search..." style="border: none; outline: none; width: 100%;">
											    </div>
									       

											<!-- Quick Filters -->
											<div id="quickFilters" style="width: 190px; height: 44px; border-radius: 10px; padding: 10px; border: 1px solid #EDEDF0;" class="dropdown d-flex align-items-center">
											    <a class="dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
											        <img src="img/filter-icon.svg" alt="Filter" style="margin-right: 6px;">
											        Quick Filters
											    </a>
											    <div class="dropdown-menu">
											        <a id="filter-active" class="dropdown-item" href="#">Active</a>
											        <a id="filter-expired-revoked" class="dropdown-item" href="#">Expired & Revoked</a>
											        <a id="filter-issued-today" class="dropdown-item" href="#">Issued Today</a>
											        <a id="filter-issued-this-month" class="dropdown-item" href="#">Issued this Month</a>
											    </div>
											</div>

									        <!-- Select Time Period -->
									        <div class="dropdown no-arrow">
									            <a class="dropdown-toggle calender-time" href="#" id="userDropdown"
									               role="button" data-toggle="dropdown"
									               aria-haspopup="true" aria-expanded="false"
									               style="width: 190px; height: 44px; border-radius: 10px; padding: 10px; border: 1px solid #EDEDF0;">
									                <span>Select Time Period</span>
									                <img src="img/calendar-time.svg" alt="">
									            </a>
									            <div class="dropdown-menu dropdown-menu-right shadow" aria-labelledby="userDropdown">
									                <a class="dropdown-item py-2" id="currentMonth" href="#">Current Month</a>
									                <a class="dropdown-item py-2" id="lastMonth" href="#">Last Month</a>
									                <a class="dropdown-item py-2" id="currentFY" href="#">Current Financial Year</a>
									                <a class="dropdown-item py-2" id="lastFY" href="#">Last Financial Year</a>
									                <a class="dropdown-item py-2" id="allHistory" href="#">All History</a>
									            </div>
									        </div>
									    </div>
									</div>

                                    <div >
										<div >
											<div class="download-btn-container">
											    <div class="tooltip-wrapper" style="margin-right: 10px;">
											        <img id="revokeTrigger" src="img/Revoke-grey.svg" alt="Revoke Icon">
											        <div class="tooltip-text">Revoke bulk vouchers</div>
											    </div>

											    <div class="tooltip-wrapper">
											        <img src="img/download-grey.svg" alt="Download Icon">
											        <div class="tooltip-text">Download voucher details</div>
											    </div>
											</div>
										   <ul class="nav nav-underline" id="dashboardTabs" role="tablist">
										    
										    
										     <li class="nav-item">
										       <a class="nav-link active" data-toggle="tab" href="#vouchers" role="tab">Vouchers</a>
										     </li>
											 <li class="nav-item">
	 									       <a class="nav-link" data-toggle="tab" href="#transactions" role="tab">Transactions</a>
	 									     </li>
											
											
										   </ul>
										  
										   <hr class="mt-0">

										   <div class="tab-content mt-3">
											<!--vouchers tab-->
											<div class="tab-pane fade show active" id="vouchers" role="tabpanel">
											<div class="table-responsive" >
											   <table class="table table-reimbursements mb-0" id="vouchersTableList" style="border: 1px solid #EAF4EF; border-radius: 10px;font-size: 13px;">
											     <!--<thead>
											       <tr>
													<th style="width: 40px;">
											          <input type="checkbox" id="checkAll">
											        </th>
												  <th>Issue Date</th>
											         
											         <th>Name & Mobile#</th>	
												  	 
											         <th>Voucher ID</th>
											        
												  <th>Bank A/c</th>	
												  <th>Category</th>	
												  <th>Redemptions</th>	
												  <th>Expiry Date</th>	
												  <th>Status</th>	
												  <th>Redemption Status</th>	
												  <th>Issued</th>
												  <th>Redeemed</th>		  
												  <th></th>
											       </tr>
											     </thead>-->
												 <thead>
			 						                <tr>
			 										 <!-- <th>S.NO</th>-->
													 <th><input type="checkbox" id="checkAll" style="margin-left: 12px;"></th>
													 <th>Issue Date <img src="img/Sorting-updown.svg" alt="sorting"></th>	
			 										  <th>Name & Mobile # <img src="img/Sorting-updown.svg" alt="sorting"></th>
													  <th>Voucher ID</th>
													  
			 						                  <th>Bank A/c<img src="img/Sorting-updown.svg" alt="sorting"></th>
			 										  <th>Category<img src="img/Sorting-updown.svg" alt="sorting"></th>	
														<th>Redemptions</th>
			 										  
			 										  <th>Expiry Date</th>	
													  <th>Status</th>	
			 										  <th>Issued</th>	
			 										  <th>Redeemed</th>	
													  <th>Actions</th>	
			 						                </tr>
			 						              </thead>
											     <tbody class="table-bordered" >
											       <!--<tr>
													<td>
											          <input type="checkbox" class="rowCheckbox">
											        </td>
											        <td > 25/10/2024</td>
												 <td>Deepak Kumar<br>9910318405</td>
												 <td>ICICI00001145781</td>
												 <td>
											         <img src="img/indianbank.png" alt="indianbank" style="height:24px; width:24px; margin-right:4px;"> xxx0569
											        </td>
												 <td><img src="img/cup-1.svg" alt="info" style="height:24px; width:24px; ">Meal 
													</td>
													<td><img src="img/tiffinbox.svg" alt="tiffinbox" style="height:24px; width:24px;">Multiple</td>
													<td>25/11/2024</td>
													<td class="pill bg-lightgreen-txt-green-pill mt-3">Active</td>
													<td style="vertical-align: middle;">
													  <div class="pill-wide bg-lightgreen-txt-green-pill">Not Redeemed</div>
													</td>
													<td>₹50,000</td>
													<td style="text-align: right;">-<img src="img/history-icon-gray.png" alt="info" style="height:24px; width:24px; margin-left:14px;"></td>
													<td>
											       	<i class="fas fa-ellipsis-v fa-sm view-voucher-details" style="cursor: pointer;"></i>
												   </td>
											       </tr>
												   
												     <tr>
												   <td>
												        <input type="checkbox" class="rowCheckbox">
												      </td>
												      <td> 25/10/2024</td>
												   <td>Atul Kumar<br>9910318405</td>
												   <td>ICICI00001145781</td>
												   <td>
												       <img src="img/indianbank.png" alt="indianbank" style="height:24px; width:24px; margin-right:4px;"> xxx8798
												      </td>
												   <td><img src="img/fuel-1.svg" alt="info" style="height:24px; width:24px; ">Fuel
												   </td>
												   <td><img src="img/single-redemption-green.svg" alt="single-redemption-green" style="height:24px; width:24px;">Single</td>
												   <td>25/11/2024</td>
												   <td class="pill bg-grey-txt-grey-pill  mt-3">Expired</td>
												   
												   <td style="vertical-align: middle;">
   													  <div class="pill-wide bg-grey-txt-grey-pill">Fully Redeemed</div>
   													</td>
												   <td>₹50,000</td>
												   <td style="text-align: right;">-<img src="img/history-icon-gray.png" alt="info" style="height:24px; width:24px; margin-left:14px;"></td>
												   <td>
											       	<i class="fas fa-ellipsis-v fa-sm view-voucher-details" style="cursor: pointer;"></i>
												   </td>
												     </tr>	-->							
																	
											     </tbody>
											   </table>
											 </div>


											 
											</div>

											 
											<!-- transactions tab-->
										     <div class="tab-pane fade" id="transactions" role="tabpanel">
												<div class="table-responsive">
												  <table class="table table-reimbursements mb-0" id="vouchersTableTransactionList" style="border: 1px solid #EAF4EF; border-radius: 10px;font-size: 13px;">
													<thead>
												      <tr>	
													  <th><input type="checkbox" id="checkAll" style="margin-left: 24px;"></th>						
													  <th>Date & Time<img src="img/Sorting-updown.svg" alt="sorting"></th>
												      <th>Voucher ID<img src="img/Sorting-updown.svg" alt="sorting"></th>	
													  <th>Transaction RRN<img src="img/Sorting-updown.svg" alt="sorting"></th>
												      <th>Name & Mobile #<img src="img/Sorting-updown.svg" alt="sorting"></th>
													  <th>Category<img src="img/Sorting-updown.svg" alt="sorting"></th>	
													  <th>Merchant Name<img src="img/Sorting-updown.svg" alt="sorting"></th>	
													  <th>Amount<img src="img/Sorting-updown.svg" alt="sorting"></th>	
													  <!--<th>Mode of Payment</th>-->
													  
												      </tr>
												    </thead>
												    <tbody class="table-bordered" >
												      <!--<tr>
										       		  <td>21/04/2024<br>
														17:57:13</td>
													 <td>ICICI00001145781</td>
													 <td>
														CDL-0424-003
												       </td>
													   <td>Deepak Kumar<br>9910318405</td>
													 <td><img src="img/fuel-grey.png" alt="tiffinbox" style="height:24px; width:24px; margin-right:10px;">Fuel
														</td>
														<td>Indian Oil</td>
														<td style="text-align: right;">16,890</td>
														
														
												      </tr>							
													  <tr>
											       		  <td>21/04/2024<br>
															17:57:13</td>
														 <td>ICICI00001145781</td>
														 <td>
															CDL-0424-003
													       </td>
														   <td>Atul Kumar<br>9910318405</td>
														 <td><img src="img/food-icon-grey.png" alt="tiffinbox" style="height:24px; width:24px; margin-right:10px;">Food
															</td>
															<td>Anna Dosa</td>
															<td style="text-align: right;">890</td>
															
															
													      </tr>		-->				
												    </tbody>
												  </table>
												</div>											
										     </div>
											 


										   </div>
										 </div>
                                        
                                    </div>
                                </div>--
								
                            </div>

                        </div>
                    </div>

                </div>
                <!-- /.container-fluid -->

            </div>
            <!-- End of Main Content -->
        </div>
		
		<div class="lds-spinner" id="signinLoader" style="display: none">
						<div></div>
						<div></div>
						<div></div>
						<div></div>
						<div></div>
						<div></div>
						<div></div>
						<div></div>
						<div></div>
						<div></div>
						<div></div>
						<div></div>
					</div>
					
        <!-- End of Content Wrapper -->

		

		
    </div>
    <!-- End of Page Wrapper -->

    <!-- Scroll to Top Button-->
    <a class="scroll-to-top rounded" href="#page-top">
        <i class="fas fa-angle-up"></i>
    </a>

    <!-- Bootstrap core JavaScript-->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Core plugin JavaScript-->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Custom scripts for all pages-->
    <script src="js/sb-admin-2.min.js"></script>

    <!-- Page level plugins -->
    <script src="vendor/datatables/jquery.dataTables.min.js"></script>
    <script src="vendor/datatables/dataTables.bootstrap4.min.js"></script>

    <!-- Page level custom scripts -->
    <script src="js/demo/datatables-demo.js"></script>
	<script type="text/javascript" src="cotodel-js/upi-voucher-issuance.js"></script>
	<!-- Include SheetJS -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
	<!--<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>-->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
	<script>
	/*document.addEventListener("DOMContentLoaded", function () {
	    const downloadBtn = document.querySelector('.download-btn-container img[alt="Download Icon"]');
	    
	    downloadBtn.addEventListener("click", function () {
	        const table = document.querySelector("#vouchersTableList");
	        const headerCells = table.querySelectorAll("thead tr th");
	        const rows = table.querySelectorAll("tbody tr");
	        const data = [];

	        // Build header row (excluding 1st and last columns)
	        const headerRow = Array.from(headerCells)
	            .slice(1, -1)  // Exclude checkbox and last column
	            .map(th => th.innerText.trim());
	        data.push(headerRow);

	        // Loop through each checked row
	        rows.forEach(row => {
	            const checkbox = row.querySelector("input.rowCheckbox");
	            if (checkbox && checkbox.checked) {
	                const cells = row.querySelectorAll("td");
	                const rowData = Array.from(cells)
	                    .slice(1, -1)  // Exclude checkbox and last column
	                    .map(td => td.innerText.trim());
	                data.push(rowData);
	            }
	        });

	        // Abort if no data selected
	        if (data.length <= 1) {
	            alert("Please select at least one row to download.");
	            return;
	        }

	        // Export to Excel
	        const ws = XLSX.utils.aoa_to_sheet(data);
	        const wb = XLSX.utils.book_new();
	        XLSX.utils.book_append_sheet(wb, ws, "Vouchers");

	        XLSX.writeFile(wb, "vouchers_selected.xlsx");
	    });
	});*/
	
	//downloading according to which tab is on 
	// 1. Checkbox select-all and export for Transactions tab
	// 2. Hide revoke image in Transactions tab ONLY
	// 3. Keep download icon always visible
	// 4. Enable scripts per active tab dynamically

	$(document).ready(function () {
	  function bindVoucherDownload() {
	    const table = document.querySelector('#vouchersTableList');
	    const headerCells = table.querySelectorAll("thead tr th");
	    const rows = table.querySelectorAll("tbody tr");
	    const data = [];

	    const headerRow = Array.from(headerCells)
	      .slice(1, -1)
	      .map(th => th.innerText.trim());
	    data.push(headerRow);

	    rows.forEach(row => {
	      const checkbox = row.querySelector("input.rowCheckbox");
	      if (checkbox && checkbox.checked) {
	        const cells = row.querySelectorAll("td");
	        const rowData = Array.from(cells)
	          .slice(1, -1)
	          .map(td => td.innerText.trim());
	        data.push(rowData);
	      }
	    });

	    if (data.length <= 1) {
	      alert("Please select at least one row to download.");
	      return;
	    }

	    const ws = XLSX.utils.aoa_to_sheet(data);
	    const wb = XLSX.utils.book_new();
	    XLSX.utils.book_append_sheet(wb, ws, "Vouchers");
	    XLSX.writeFile(wb, "vouchers_selected.xlsx");
	  }

	  function bindTransactionDownload() {
	    const table = document.querySelector('#vouchersTableTransactionList');
	    const headerCells = table.querySelectorAll("thead tr th");
	    const rows = table.querySelectorAll("tbody tr");
	    const data = [];

	    const headerRow = Array.from(headerCells)
	      .slice(1, -1)
	      .map(th => th.innerText.trim());
	    data.push(headerRow);

	    rows.forEach(row => {
	      const checkbox = row.querySelector("input.rowCheckbox");
	      if (checkbox && checkbox.checked) {
	        const cells = row.querySelectorAll("td");
	        const rowData = Array.from(cells)
	          .slice(1, -1)
	          .map(td => td.innerText.trim());
	        data.push(rowData);
	      }
	    });

	    if (data.length <= 1) {
	      alert("Please select at least one row to download.");
	      return;
	    }

	    const ws = XLSX.utils.aoa_to_sheet(data);
	    const wb = XLSX.utils.book_new();
	    XLSX.utils.book_append_sheet(wb, ws, "Transactions");
	    XLSX.writeFile(wb, "transactions_selected.xlsx");
	  }

	  // Select/Deselect All Checkboxes in Transactions Tab
	  $('#transactions #checkAll').on('click', function () {
	    const isChecked = $(this).is(':checked');
	    $('#transactions .rowCheckbox').prop('checked', isChecked);
	  });

	  // Manage revoke icon visibility and bind click handler on tab change
	  $('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
	    const target = $(e.target).attr("href");
	    const downloadIcon = $('.download-btn-container img[alt="Download Icon"]');

	    if (target === '#transactions') {
	      $('#revokeTrigger').hide();
	      downloadIcon.off('click').on('click', bindTransactionDownload);
	    } else if (target === '#vouchers') {
	      $('#revokeTrigger').show();
	      downloadIcon.off('click').on('click', bindVoucherDownload);
	    }
	  });

	  // Initialize based on active tab on load
	  const initialTab = $('#dashboardTabs .nav-link.active').attr('href');
	  const downloadIcon = $('.download-btn-container img[alt="Download Icon"]');
	  if (initialTab === '#transactions') {
	    $('#revokeTrigger').hide();
	    downloadIcon.off('click').on('click', bindTransactionDownload);
	  } else {
	    $('#revokeTrigger').show();
	    downloadIcon.off('click').on('click', bindVoucherDownload);
	  }
	});


	</script>
<script>	// Show modal with selected data
	$('#revokeTrigger').on('click', function () {
	  const selectedRows = $('.rowCheckbox:checked').map(function () {
	    return $('#vouchersTableList').DataTable().row($(this).closest('tr')).data();
	  }).get();

	  if (selectedRows.length === 0) {
	    alert("Please select at least one voucher to revoke.");
	    return;
	  }

	  if (selectedRows.length > 5) {
	    alert("You can revoke a maximum of 5 vouchers at a time.");
	    return;
	  }
	  // Only allow Active vouchers (type === "Created")
	  const invalidRows = selectedRows.filter(row => row.type !== "Created");

	  if (invalidRows.length > 0) {
	    alert("Only Active vouchers can be revoked.");
	    return;
	  }

	  // Populate modal table
	  const modalBody = $('#bulkRevokeTableBody');
	  modalBody.empty();

	  // Construct full table with header
	  const table = $(`
	    <table class="table table-reimbursements mb-0 w-100 text-nowrap">
	      <thead>
	        <tr>
	          <th style="width: 100px;">Issue Date</th>
	          <th style="width: 180px;">Name & Mobile</th>
	          <th style="width: 200px;">Voucher ID</th>
	          <th style="width: 120px;">Bank A/c</th>
	          <th style="width: 140px;">Category</th>
	          <th style="width: 140px;">Redemptions</th>
	          <th style="width: 120px;">Expiry Date</th>
	          <th style="width: 100px;">Status</th>
	          <th style="width: 100px;">Issued</th>
	          <th style="width: 100px;">Redeemed</th>
	        </tr>
	      </thead>
	      <tbody></tbody>
	    </table>
	  `);

	  selectedRows.forEach(row => {
		const redemptionIcon = row.redemtionType === 'Single'
		  ? 'img/single-redemption-green.svg'
		  : row.redemtionType === 'MULTIPLE'
		    ? 'img/tiffinbox.svg'
		    : '';

		const rowHtml = `
		  <tr class="bulkRevokeRow">
		    <td>${formatDate(row.creationDate)}</td>
		    <td>${row.name}<br>${row.mobile}</td>
		    <td>${row.merchanttxnId}</td>
		    <td>
		      <img src="data:image/png;base64,${row.bankIcon}" alt="bank" style="height: 16px; vertical-align: middle; margin-right: 4px;">
		      xxxx${row.accountNumber.slice(-4)}
		    </td>
		    <td>
		      <img src="data:image/png;base64,${row.mccMainIcon}" alt="category" style="height: 16px; vertical-align: middle; margin-right: 4px;">
		      ${row.purposeDesc}
		    </td>
		    <td>
		      <img src="${redemptionIcon}" alt="${row.redemtionType}" style="height: 16px; vertical-align: middle; margin-right: 4px;">
		      ${row.redemtionType}
		    </td>
		    <td>${formatDate(row.expDate)}</td>
		    <td>${row.type}</td>
		    <td class="text-right">₹${parseFloat(row.amount).toLocaleString('en-IN')}</td>
		    <td class="text-right">₹${parseFloat(row.redeemAmount || 0).toLocaleString('en-IN')}</td>
		  </tr>
		`;


	    table.find('tbody').append(rowHtml);
	  });
	  modalBody.append(table);

	  // Ensure modal is inside body before showing
	  if (!$('#bulkrevokeModal').parent().is('body')) {
	    $('#bulkrevokeModal').detach().appendTo('body');
	  }

	  $('#bulkrevokeModal').modal('show');
	});

	// Ensure modal appears above overlay
	$('#bulkrevokeModal').on('shown.bs.modal', function () {
	  $(this).css('z-index', 1055);
	  $('.modal-backdrop').last().css('z-index', 1050);
	});

	

	
	// Send to backend on confirm revoke
	  $(document).ready(function () {
	    $('#bulkBtnRevoke').on('click', function () {
	      const selectedIds = $('.rowCheckbox:checked').map(function () {
	        return $(this).data('id');
	      }).get();

	      if (selectedIds.length === 0) {
	        alert("Please select at least one voucher to revoke.");
	        return;
	      }

	      // Store globally
	      window.selectedVoucherIdsToRevoke = selectedIds;

	      // Trigger OTP send
	     // $('#bulkbtnRevoke').trigger('click'); // This triggers OTP process
		 triggerBulkOtpSend();
	    });
	  });



</script>
	<script>/*search filter*/
		const searchInput = document.getElementById('searchInput');
		const table = document.getElementById('vouchersTableList');
		const tbody = table.querySelector('tbody');
		const clearFiltersBtn = document.getElementById('clearFilters');

		let cachedRows = [];

		function enableClearButton(enabled) {
		    clearFiltersBtn.style.cursor = enabled ? 'pointer' : 'not-allowed';
		    clearFiltersBtn.style.opacity = enabled ? '1' : '0.5';
		    clearFiltersBtn.disabled = !enabled;
		}

		enableClearButton(false);

		searchInput.addEventListener('input', () => {
		    const query = searchInput.value.toLowerCase().trim();

		    if (cachedRows.length === 0) {
		        cachedRows = Array.from(tbody.querySelectorAll('tr'));
		    }

		    tbody.innerHTML = '';

		    if (query === '') {
		        cachedRows.forEach(row => tbody.appendChild(row.cloneNode(true)));
		        enableClearButton(false);
		        return;
		    }

		    const matches = cachedRows.filter(row => row.textContent.toLowerCase().includes(query));
		    matches.forEach(row => tbody.appendChild(row.cloneNode(true)));
		    enableClearButton(true);
		});

		function clearAllFilters() {
		    if (clearFiltersBtn.style.cursor === 'not-allowed') return;
		    searchInput.value = '';
		    tbody.innerHTML = '';

		    if (cachedRows.length === 0) {
		        cachedRows = Array.from(tbody.querySelectorAll('tr'));
		    }

		    cachedRows.forEach(row => tbody.appendChild(row.cloneNode(true)));
		    enableClearButton(false);
		}

		clearFiltersBtn.addEventListener('click', clearAllFilters);
	</script>
	<script>/*date filter*/	
			document.addEventListener("DOMContentLoaded", function () {
	  function updateSelectedLabel(label) {
	    const dropdownLabel = document.querySelector(".dropdown-toggle.calender-time span");
	    dropdownLabel.textContent = label;
	  }

	  function callPeriod(periodKey, label) {
	    const periodMap = {
	      currentMonth: "CM",
	      lastMonth: "LM",
	      currentFY: "CFY",
	      lastFY: "LFY",
	      allHistory: "AH"
	    };
	    const period = periodMap[periodKey] || "AH";
	    updateSelectedLabel(label);
	    erupiVoucherCreateListLimit(period);

	    // Smooth scroll to content after a short delay to allow data rendering
	    setTimeout(() => {
	      const section = document.querySelector(".upi-voucher-wrap");
	      if (section) {
	        section.scrollIntoView({ behavior: "smooth", block: "start" });
	      }
	    }, 300); // Adjust delay if needed
	  }

	  // Prevent scroll jump by default and trigger callPeriod
	  const addFilterEvent = (id, key, label) => {
	    const el = document.getElementById(id);
	    if (el) {
	      el.addEventListener("click", (e) => {
	        e.preventDefault();
	        callPeriod(key, label);
	      });
	    }
	  };

	  addFilterEvent("currentMonth", "currentMonth", "Current Month");
	  addFilterEvent("lastMonth", "lastMonth", "Last Month");
	  addFilterEvent("currentFY", "currentFY", "Current Financial Year");
	  addFilterEvent("lastFY", "lastFY", "Last Financial Year");
	  addFilterEvent("allHistory", "allHistory", "All History");
	});


</script>
	<script type="text/javascript">

	$(document).ready(function(){
		
		  $('li.active').removeClass('active').removeAttr('aria-current'); 
		  $('a[href="' +'/upiVoucherIssuanceNew"]').closest('li').addClass('active').attr('aria-current', 'page');   
		  
	   $(".innernav").click(function(){
	       $(".dropdownNav").addClass("active");
	   });
	});

	</script>
	<script>
		document.getElementById('requestedVoucher').addEventListener('click', function () {
		    document.getElementById('bellCountBadge').style.display = 'none';
		    window.location.href = '/requestedUpiVoucherIssuance'; // ← replace with actual target page URL
		});

	</script>
	
    <script>
        $(document).ready(function () {
            $("#hide").click(function () {
                $(".ftr-content").hide();
            });
            $("#show").click(function () {
                $(".ftr-content").show();
            });
        });

        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        });


        jQuery(document).ready(function ($) {
            var bsOverlay = $('.bs-canvas-overlay');
            $('[data-toggle="canvas"]').on('click', function () {
                var ctrl = $(this),
                    elm = ctrl.is('button') ? ctrl.data('target') : ctrl.attr('href');
                $(elm).addClass('mr-0');
                $(elm + ' .bs-canvas-close').attr('aria-expanded', "true");
                $('[data-target="' + elm + '"], a[href="' + elm + '"]').attr('aria-expanded', "true");
                if (bsOverlay.length)
                    bsOverlay.addClass('show');
                return false;
            });

            $('.bs-canvas-close, .bs-canvas-overlay').on('click', function () {
                var elm;
                if ($(this).hasClass('bs-canvas-close')) {
                    elm = $(this).closest('.bs-canvas');
                    $('[data-target="' + elm + '"], a[href="' + elm + '"]').attr('aria-expanded', "false");
                } else {
                    elm = $('.bs-canvas')
                    $('[data-toggle="canvas"]').attr('aria-expanded', "false");
                }
                elm.removeClass('mr-0');
                $('.bs-canvas-close', elm).attr('aria-expanded', "false");
                if (bsOverlay.length)
                    bsOverlay.removeClass('show');
                return false;
            });
        });


        $(document).ready(function () {
           // $("#linkedAccount").click(function () {
            //    $("#linkedAccount").show();
           //     $("#nolinkBankAccount").hide();

           // });
			//$("#linkedAccount").click(function () {
           //    $("#linkedAccount").hide();
              // $("#nolinkBankAccount").hide();

          // });
		   
        });


       // $("#fundmarked").click(function () {
           // $(".activeupivcmarked").show();
		   //$("#activeupivcmarked").show();
		//	activeupivcmarked.classList.toggle('collapsed');
       // });
		
		$("#fundmarked").click(function () {
		         // $(".activeupivcmarked").show();
				//$("#activeupivcmarked").hide();
		       });

     ///   $("#fundmarked").click(function () {
           // $(".activeupivcmarked").hide();
		//	$("#activeupivcmarked").hide();
      //  });


	  $(document).ready(function () {
	            $("#btnforrevokeModal").click(function () {
	               $("#revokeModal").show();
	            });
	        });

	        $(document).ready(function () {
	            $("#btnforrevokevcModal").click(function () {
	                $("#RevokeUPIVoucherModal").show();
	                $("#revokeModal").hide();
	            });
	        });

	        $(document).ready(function () {
	            $("#issueVouchersModalAuthenticate").click(function () {
	                $("#RevokeUPIVoucherModal").hide();
	                $("#revokeUPIVcAuthenticate").show();
	            });
	        });


	        $(document).ready(function () {
	            $(".close").click(function () {
	                $("#revokeUPIVcAuthenticate").hide();
	            });
	        });
			$(document).ready(function () {
	            $(".close").click(function () {
	                $("#smsUPIVcAuthenticate").hide();
	            });
	        });
			
			$(document).ready(function () {
            $(".close").click(function () {
                $("#smsUPIVcAuthenticateFail").hide();
            });
        });

			$(document).ready(function () {
	            $(".close").click(function () {
	                $("#revokeUPIVcAuthenticateFail").hide();
	            });
	        });

	        $(document).ready(function () {
	            $("#cancelbtn").click(function () {
	                $("#revokeModal").hide();
	            });
	        });

	        $(document).ready(function () {
	            $("#btnforinfomodal").click(function () {
	                $("#explainvcIssuanceStatModal").show();
	            });
	        });

	        $(document).ready(function () {
	            $("#vcIssuanStatok").click(function () {
	                $("#explainvcIssuanceStatModal").hide();
	            });
	        });

	        $(document).ready(function () {
	            $(".close").click(function () {
	                $("#explainvcIssuanceStatModal").hide();
	            });
	        });

    </script>
	

	<script>
		document.addEventListener("DOMContentLoaded", function () {
		  const button = document.getElementById('fundmarked');
		  const div = document.getElementById('myDiv');

		  button.addEventListener('click', function (e) {
		    e.preventDefault();
		    div.style.display = div.style.display === "none" ? "block" : "none";
		  });
		});
	</script>
	<script>
		
		const requestedVoucher = document.getElementById('requestedVoucher');
			    requestedVoucher.addEventListener('click', () => {
			        if (!requestedVoucher.disabled) {
			            window.location.href = '/requestedUpiVoucherIssuance';
			        }
			    });
				
	    const issueManually = document.getElementById('issueManually');
	    issueManually.addEventListener('click', () => {
	        if (!issueManually.disabled) {
	            window.location.href = '/upiVoucherIssuanceManually';
	        }
	    });

	  
		const issueBulk = document.getElementById('issueBulk');
	    issueBulk.addEventListener('click', () => {
	        if (!issueBulk.disabled) {
	            window.location.href = '/issueWithBulkUploadVoucher';
	        }
	    });
		
	</script>
	
	<script>
			
			let revokeValue = null;

			function openRevokeDialog(rowData) {
				
				if (typeof rowData === "string") {
				     rowData = JSON.parse(decodeURIComponent(rowData));
				  }

				  // Populate your popup/modal with the row data
				  document.getElementById("revokeId").value = rowData.id; // Example
				  document.getElementById("popupFieldName").textContent = rowData.name; 
				  document.getElementById("popupFieldMobile").textContent = rowData.mobile; 
				  document.getElementById("popupFieldAmount").textContent = rowData.amount; 
				  document.getElementById("popupFieldpurposeDesc").textContent = rowData.purposeDesc; 
				  
				  document.getElementById("popupFieldStartDate").textContent = formatDate(rowData.creationDate);
				  document.getElementById("popupFieldExpiryDate").textContent = formatDate(rowData.expDate);

			      revokeValue = rowData.value; // Store the button value
			      document.getElementById("revokeModal").style.display = "flex";
			}
			function closeRevokeDialog() {
			    document.getElementById("revokeModal").style.display = "none";
			}
			function formatDate(dateStr) {
			    const date = new Date(dateStr);
			    const day = String(date.getDate()).padStart(2, '0');
			    const month = String(date.getMonth() + 1).padStart(2, '0'); // months are 0-indexed
			    const year = date.getFullYear();
			    return `${day}-${month}-${year}`;
			}
			function confirmRevokeDialog() {
			    console.log("Revoke confirmed for value:", revokeValue);
			    revoke(revokeValue);
			    closeRevokeDialog();
			}
		//	document.getElementById("confirmButton").addEventListener("click", confirmRevokeDialog);
		//	document.getElementById("cancelButton").addEventListener("click", closeRevokeDialog);
		
		let resendValue = null;

					function sendSMSModal(rowData) {
						
						if (typeof rowData === "string") {
						     rowData = JSON.parse(decodeURIComponent(rowData));
						  }

						  // Populate your popup/modal with the row data
						 
						 // document.getElementById("popupField").textContent = rowData.amount; // Example


					    resendValue = rowData.value; // Store the button value
					    document.getElementById("sendSMSModal").style.display = "flex";
					}
					function closeresendDialog() {
					    document.getElementById("sendSMSModal").style.display = "none";
					}

					function confirmRevokeDialog() {
					    console.log("Revoke confirmed for value:", resendValue);
					    resendsms(resendValue);
					    closeresendDialog();
					}
				//	document.getEle
</script>
	
<script>
	

	document.addEventListener("DOMContentLoaded", function () {

	    function callAPI(period) {
			//period="AH";		  
	        if (period === "currentMonth") {
			period="CM" ;
	        } else if (period === "lastMonth") {
			period="LM" ;
	        }
		   else if (period === "currentYear") {
			period="CY";
	           }
		   else if (period === "lastMonthYear") {
			period="LMY";
		   	}
			else if (period === "currentFY") {
			period="CFY";
		   	}
			else if (period === "lastFY") {
			period="LFY";
		   	}
			else if (period === "allHistory") {
			period="AH";
		   	}
			else{
				period="AH";
			}

		document.getElementById("signinLoader").style.display="flex";
		var employerid = document.getElementById("employerId").value;
		$.ajax({
			type: "POST",
			url: "/getIssueVoucherList",
			data: {
				"orgId": employerid,
				"timePeriod":period,
			},
			success: function(data) {
				newData = data;
				var data1 = jQuery.parseJSON(newData);
				var data2 = data1.data;
				 //console.log(data2);
				document.getElementById("signinLoader").style.display="none";
				
				var table = $('#issueVoucherTable').DataTable( {
		          destroy: true,	
				 // "dom": 'rtip',
				 //dom: 'Bfrtip',
			     "responsive": true, searching: true,bInfo: false, paging: true,"lengthChange": true, "autoWidth": false,"pagingType": "full_numbers","pageLength": 50,
		         "buttons": ["csv", "excel"],
		         "language": {"emptyTable": "UPI Vouchers section is currently not enabled. Please link your bank account to enable this section."  },
		         "aaData": data2,
		  		  "aoColumns": [ 
					{ "mData": "id", "render": function (data2, type, row) {
					   return ' <div class="table-check"><input type="hidden" class="checkBoxClass" value="'+data2+'" id="'+data2+'" name="revoke"></div>';
				    }}, 
					{ "mData": "name"},
		            { "mData": "mobile"},   
					/*{ "mData": "accountNumber", "render": function (data2, type, row) {
						
					 return '<div class="tdflex"><img src="img/indianbank.png" width="16px" alt=""><span" ></span></div>';
									  
					}},*/
				    { "mData": "accountNumber"},   
					{ "mData": "purposeDesc"},  
					//{ "mData": "mcc"}, 
					{ "mData": "amount"},
					{ "mData": "creationDate"},
					{ "mData": "expDate"},
					{ "mData": "redemtionType"},
					{ "mData": "type"},      
					
					{ "mData": "id", "render": function (data2, type, row) {
					    if (row.type === "Revoke" || row.type === "fail" || row.type === "Redeem") {
					        return '';
					    } else {
					        return `
					            <td>
					                <div class="dropdown no-arrow ml-2">
					                    <a class="dropdown-toggle" href="#" id="userDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
					                        <i class="fas fa-ellipsis-v fa-sm"></i>
					                    </a>
					                    <br>
					                    <div class="dropdown-menu dropdown-menu-right shadow" aria-labelledby="userDropdown">
					                        <button 
					                            class="dropdown-item py-2" 
					                            value="${data2}" 
					                            id="btnRevoke" 
					                            onclick="openRevokeDialog('${encodeURIComponent(JSON.stringify(row))}')">
					                            Revoke
					                        </button>
					                        <button 
					                            class="dropdown-item py-2"  
					                            data-toggle="modal" 
					                            data-target="#tableSendSms" 
					                            value="${data2}" 
					                            id="btnSend" 
					                            onclick="sendsms('${encodeURIComponent(JSON.stringify(row))}')">
					                            Send SMS
					                        </button>
					                    </div>
					                </div>
					            </td>`;
							}
					    }}, 
				
				 	],
					
					createdRow: function (row, data2, dataIndex) 
		                {
		               
		             	var voucherDesc = data2.voucherDesc;
		             	var type = data2.type;
						
		                 if(voucherDesc=="Meal")
		                 {
						 var imgTag = '<img src="img/food.svg" alt="" class="mr-2">'+voucherDesc;
		                  $(row).find('td:eq(1)').html(imgTag);
		                 }
		                 if(voucherDesc=="Miscellaneous")
		                 {
						 var imgTag = ' <img src="img/Miscellaneous.svg" alt="" class="mr-2">'+voucherDesc;
						
		                  $(row).find('td:eq(1)').html(imgTag);
		                 }
		                 
		                 if(voucherDesc=="Food")
		                 {
							 var imgTag = ' <img src="img/food.svg" alt="" class="mr-2">'+voucherDesc;
		 					 $(row).find('td:eq(1)').html(imgTag);
		                 }
		                 
		                 if(voucherDesc=="Cash Advance")
		                 {
						 var imgTag = '<img src="img/cash.svg" alt="" class="mr-2">'+voucherDesc;
		                  $(row).find('td:eq(1)').html(imgTag);
		                 }
		                 if(voucherDesc=="Travel")
		                 {
						 var imgTag = '<img src="img/Travel.svg" alt="" class="mr-2">'+voucherDesc;
						
		                  $(row).find('td:eq(1)').html(imgTag);
		                 }
		                 if(voucherDesc=="Stay")
		                 {
						 var imgTag = '<img src="img/hotel.svg" alt="" class="mr-2">'+voucherDesc;
		                  $(row).find('td:eq(1)').html(imgTag);
		                 }
		                 
		                 if(type=="fail")
		                 {
							var imgTag = ' <img src="img/table-fail.svg" alt="" class="mr-2">';
							 $(row).find('td:eq(9)').html(imgTag);
		                //  $(row).find('td:eq(10)').addClass('tdactive');
		                 }
		                 if(type=="Created")
		                 {
							var imgTag = ' <img src="img/table-create.svg" alt="" class="mr-2">';
							 $(row).find('td:eq(9)').html(imgTag);
		                 // $(row).find('td:eq(10)').addClass('tdsubmitted');
		                 }
						 if(type=="Revoke")
		                 {
					
							var imgTag = ' <img src="img/Revoke.svg" alt="" class="mr-2">';
						    $(row).find('td:eq(9)').html(imgTag);
						 
		                 }
						 if(type=="Redeem")
		                 {
							var imgTag = ' <img src="img/Redeem.svg" alt="" class="mr-2">';
							 $(row).find('td:eq(9)').html(imgTag);
		                 }
						 var bankcode = data2.bankcode;
						 var bankIcon = data2.bankIcon;
						 var accountNumber = data2.accountNumber;
						 if(bankcode=="ICICI")
		                 {	
		 					 var imgTag = ' <img src="data:image/png;base64,' + bankIcon + '" alt=""] width="16px" height=""16px>';
		 					 $(row).find('td:eq(3)').html(imgTag+" "+accountNumber);
		                 }
		              }
				});
		  		//}).buttons().container().appendTo('#issueVoucherTable_wrapper .col-md-6:eq(0)');		
				
			},
			error: function(e) {
				alert('Failed to fetch JSON data' + e);
			}
		});  
	       
	    }
		
		/*function updateSelectedLabel(label) {
		        const dropdownLabel = document.querySelector(".dropdown-toggle.calender-time span");
		        dropdownLabel.textContent = label;
		    }
			
	    // Add event listeners for dropdown items
	    document.getElementById("currentMonth").addEventListener("click", function () {
			updateSelectedLabel("Current Month");
	        callAPI("currentMonth");
	    });

	    document.getElementById("lastMonth").addEventListener("click", function () {
			updateSelectedLabel("Last Month");
	        callAPI("lastMonth");
	    });
		document.getElementById("currentFY").addEventListener("click", function () {
			updateSelectedLabel("Current Financial Year");
		        callAPI("currentFY");
		 });
	    document.getElementById("lastFY").addEventListener("click", function () {
			updateSelectedLabel("Last Financial Year");
	        callAPI("lastFY");
	    });
		document.getElementById("allHistory").addEventListener("click", function () {
			updateSelectedLabel("All History");
			        callAPI("allHistory");
		});*/
		
	});
	
</script>
<script>
		function closeRevokeUPIVoucherModal() {
		    document.getElementById("RevokeUPIVoucherModal").style.display = "none";
		}
		function closeRevokebulkUPIVoucherModal() {
				    document.getElementById("RevokebulkUPIVoucherModal").style.display = "none";
					// Remove ALL modal backdrops
					   document.querySelectorAll('.modal-backdrop').forEach(backdrop => backdrop.remove());

					   // Remove modal-open class from body
					   document.body.classList.remove('modal-open');

					   // Optional: Reset body overflow if it was locked
					   document.body.style.overflow = '';
				}
		</script>
<script>
			function toggleOtpVisibility2() {
			    const icon = document.getElementById("toggleOtpIcon2");
			    const inputs = document.querySelectorAll('.otp-box-onboarding input');

			    const isHidden = inputs[0].type === 'password';
			    inputs.forEach(input => {
			        if (input.id.startsWith('password')) {
			            input.type = isHidden ? 'text' : 'password';
			        }
			    });

			    icon.classList.toggle('fa-eye');
			    icon.classList.toggle('fa-eye-slash');
			}
			
			function toggleOtpVisibility3() {
			    const icon = document.getElementById("toggleOtpIcon3");
			    const inputs = document.querySelectorAll('.otp-box-onboarding input');

			    const isHidden = inputs[0].type === 'password';
			    inputs.forEach(input => {
			        if (input.id.startsWith('password')) {
			            input.type = isHidden ? 'text' : 'password';
			        }
			    });

			    icon.classList.toggle('fa-eye');
			    icon.classList.toggle('fa-eye-slash');
			}
			</script>
<style>			.collapsed {
			    display: none !important;
			  }
			  #bulkrevokeModal {
			    z-index: 1055 !important;
			  }
			 
			  .tooltip-wrapper {
			      position: relative;
			      display: inline-block;
			      cursor: pointer;
			  }

			  .tooltip-wrapper .tooltip-text {
			      visibility: hidden;
			      background-color: #333;
			      color: #fff;
			      text-align: center;
			      border-radius: 4px;
			      padding: 5px 8px;
			      position: absolute;
			      z-index: 1;
			      bottom: 125%; /* show above */
			      left: 50%;
			      transform: translateX(-50%);
			      white-space: nowrap;
			      font-size: 12px;
			      opacity: 0;
			      transition: opacity 0.3s;
			  }

			  .tooltip-wrapper:hover .tooltip-text {
			      visibility: visible;
			      opacity: 1;
			  }
			 

			 

		  </style>
</body>

</html>

<!-- Modal Issue Vouchers -->
<div class="customModal" id="revokeModal">
    <div class="modal-dialog modal-dialog-centered modal-approval-wrap modal-xxl" role="document">
        <div class="modal-content modal-bulk p-0">
            <div class="modal-header pb-0 text-center">
                <h5 class="modal-title w-100" id="exampleModalCenterTitle">Are you sure?</h5>
            </div>
            <hr>
            <p class="text-dark">Please confirm if you would like to ‘Revoke’ this UPI Vouchers.</p>
            <div class="modal-body text-center">
              
				<div class="table-responsive">
				                <div class="table table-reimbursements table-upivouchers">
				                    <div class="tablehead">
										<input type="hidden" id="revokeId">
				                        <div class="tabletheadtr">
				                            <span>Name <img src="img/Sort.png" alt=""></span>
											<span></span>
				                            <span>Mobile</span>
											<span>Amount </span>
				                           <!-- <span>Bank A/c </span>-->
				                            <span>Voucher &amp; Type <img src="img/Sort.png" alt=""></span>
				                            <span>Status <img src="img/Sort.png" alt=""></span>
				                            <span>Issue Date <img src="img/Sort.png" alt=""></span>
				                            <span>Expiry Date</span>
				                        </div>
				                    </div>

				                    <div class="tablebody">
				                        <div class="tablebodytr">
				                            <span id="popupFieldName"></span>
				                            <span id="popupFieldMobile"></span>
											<span id="popupFieldAmount"></span>
				                            <!--<span>
				                                <div class="tdflex"><img src="img/indianbank.png" width="16px"
				                                        alt=""><span id="popupFieldBankId"></span></div>
				                            </span>-->
				                            <span id="popupFieldpurposeDesc">
				                                <!--<div class="tdflex"><span id="popupFieldpurposeDesc"></span>
				                                    <div><img src="img/mealtype.svg" width="16px" alt="" data-toggle="tooltip"
				                                            data-placement="top" title="Multi Redemption">
				                                        <img src="img/info.svg" width="16px" alt="" data-toggle="tooltip"
				                                            data-placement="top" title="Single Redemption">
				                                    </div>
				                                </div>-->
				                            </span>
				                            <span><label>Active</label></span>
				                            <span id="popupFieldStartDate"></span>
				                            <span  id="popupFieldExpiryDate"></span>
				                        </div>
				                    </div>
				                </div>
				            </div>
                <div class="d-flex justify-content-center mt-3">
                    <button class="btn btn-border w-100" id="btnRevoke">REVOKE</button>
                    <button class="btn btn-primary w-100" id="cancelbtn">Cancel</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="customModal" id="bulkrevokeModal">
  <div class="modal-dialog modal-dialog-centered modal-approval-wrap modal-xxl" role="document">
    <div class="modal-content modal-bulk p-0">
      <div class="modal-header pb-0 text-center">
        <h5 class="modal-title w-100">Are you sure?</h5>
      </div>
      <hr>
      <p class="text-dark text-center">Please confirm if you would like to ‘Revoke’ these UPI Vouchers.</p>

      <div class="modal-body text-center">
        <div class="table-responsive">
          <div id="bulkRevokeTableBody" style="font-size: 13px;">
            <!-- Dynamic table will be injected here by JS -->
          </div>
        </div>

        <div class="d-flex justify-content-center mt-3">
          <button class="btn btn-border w-100" id="bulkBtnRevoke">REVOKE</button>
          <button class="btn btn-primary w-100" id="bulkcancelbtn">Back</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal Issue Vouchers -->
<div class="customModal" id="sendSMSModal" >
    <div class="modal-dialog modal-dialog-centered modal-approval-wrap modal-xxl" role="document">
        <div class="modal-content modal-bulk p-0">
            <div class="modal-header pb-0 text-center">
                <h5 class="modal-title w-100" id="exampleModalCenterTitle">Are you sure?</h5>
            </div>
            <hr>
            <p class="text-dark">Please confirm if you would like to ‘Re Send SMS’ this UPI Vouchers.</p>
            <div class="modal-body text-center">
                <div class="table-responsive">
					<p><input type="hidden" id="resendId" name="resendId" /></p>
					<p><strong>Name:</strong> <span id="popupFieldName"></span></p>
					 <p><strong>Mobile:</strong> <span id="popupFieldMobile"></span></p>
					 <p><strong>Amount:</strong> <span id="popupFieldAmount"></span></p>
                   <!-- <table class="table table-reimbursements table-upivouchers">
                        <thead>
                            <tr>
                                <th>Name <img src="img/Sort.png" alt=""></th>
                                <th>Mobile Number </th>
                                <th>Bank A/c </th>
                                <th>Voucher &amp; Type <img src="img/Sort.png" alt=""></th>
                                <th>Status <img src="img/Sort.png" alt=""></th>
                                <th>Issue Date <img src="img/Sort.png" alt=""></th>
                                <th>Expiry Date</th>
                                <th>Issued</th>
                                <th>Redeemed</th>

                            </tr>
                        </thead>

                        <tbody>
                            <tr>
                                <td>Deepak Kumar</td>
                                <td>9910318405</td>
                                <td>
                                    <div class="tdflex"><img src="img/indianbank.png" width="16px"
                                            alt=""><span>xxx0569</span></div>
                                </td>
                                <td>
                                    <div class="tdflex"><span>Meal</span>
                                        <div><img src="img/mealtype.svg" width="16px" alt="" data-toggle="tooltip"
                                                data-placement="top" title="Multi Redemption">
                                            <img src="img/info.svg" width="16px" alt="" data-toggle="tooltip"
                                                data-placement="top" title="Single Redemption">
                                        </div>
                                    </div>
                                </td>
                                <td><label>Active</label></td>
                                <td>25/10/2024</td>
                                <td>25/11/2024</td>
                                <td>₹ 5,000</td>
                                <td>₹ 2,500</td>
                            </tr>
                        </tbody>
                    </table>-->
                </div>


                <div class="d-flex justify-content-center mt-3">
                    <button class="btn btn-border w-100" id="btnResend">Send SMS</button>
                    <button class="btn btn-primary w-100" id="cancelbtn">Cancel</button>
                </div>
            </div>
        </div>
    </div>
</div>



<!-- Modal Issue Vouchers -->
<div class="customModal" id="RevokeUPIVoucherModal">
    <div class="modal-dialog modal-dialog-centered modal-approval-wrap modal-lg" role="document">
        <div class="modal-content modal-bulk p-0">
            <div class="modal-header pb-0 text-center">
                <h5 class="modal-title w-100" id="exampleModalCenterTitle">Revoke UPI Voucher</h5>
				<button type="button"
				           style="border: none; background: none; font-size: 1.5rem; position: absolute; top: 10px; right: 0px; line-height: 1; padding: 0 20px;"
				           aria-label="Close"
				           onclick="closeRevokeUPIVoucherModal()">
				       &times;
				   </button>
            </div>
			<div class="modal-body text-center">
			                <div class="otp-box-onboarding justify-content-center">
							
								<input  class="form-control form-control-sm test" type="password" id="password1" 
									oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\.*)\./g, '$1');"
							        name="password1" maxlength="1" autocomplete="off" onkeypress="focusNext(this)" onkeydown="focusBack()">
							        <input  class="form-control form-control-sm test" type="password" id="password2" 
									oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\.*)\./g, '$1');"
							        name="password2" maxlength="1" autocomplete="off" onkeypress="focusNext(this)" onkeydown="focusBack()">
							        <input  class="form-control form-control-sm test" type="password" id="password3" 
									oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\.*)\./g, '$1');"
							        name="password3" maxlength="1" autocomplete="off" onkeypress="focusNext(this)" onkeydown="focusBack()">
							        <input  class="form-control form-control-sm test" type="password" id="password4" 
									oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\.*)\./g, '$1');"
							        name="password4" maxlength="1" autocomplete="off" onkeypress="focusNext(this)" onkeydown="focusBack()">
							        <input  class="form-control form-control-sm test" type="password" id="password5" 
									oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\.*)\./g, '$1');"
							        name="password5" maxlength="1" autocomplete="off" onkeypress="focusNext(this)" onkeydown="focusBack()">
							        <input  class="form-control form-control-sm test" type="password" id="password6" 
									oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\.*)\./g, '$1');"
							        name="password6" maxlength="1" autocomplete="off" onkeydown="focusBack()">
							        <input  class="form-control form-control-sm test" type="hidden" id="orderId" 
							        name="orderId" >
									<div class="d-flex justify-content-center mt-2">
									    <i class="fa-solid fa-eye" id="toggleOtpIcon2" style="cursor: pointer;margin-top: 5px; " onclick="toggleOtpVisibility2()"></i>
									</div>
			                </div>
			               <label class="time-otp ml-0 text-dark" for="" id="countdown" style="color: green;"></label>
						  <!-- <div class="text-center" id="countdown" style="color: green;"></div>-->
							<p id="resendCode">Didn’t receive the code?  <a href="#" onclick="resendVoucherOTP()">Resend OTP</a></p>
							<p class="error-msg" id="otpError" style="color:red"></p>
			                    <p class="mb-0" id="maskedMobileDisplay"></p>
			                </div>
			                <div class="d-flex justify-content-center mt-3">
								<button class="btn btn-primary w-100" id="authenticate" onclick="verfyIssueVoucherOTP()">Authenticate</button>
			                </div>
			            </div>
			      
        </div>
    </div>
</div>

<!-- Modal revoke bulk Vouchers -->
<div class="customModal" id="RevokebulkUPIVoucherModal" style="z-index: 1055; display: none; padding-top: 5%;">
    <div class="modal-dialog modal-dialog-centered modal-approval-wrap modal-lg" role="document">
        <div class="modal-content modal-bulk p-0">
            <div class="modal-header pb-0 text-center">
                <h5 class="modal-title w-100" id="exampleModalCenterTitle">Revoke Bulk UPI Voucher</h5>
				<button type="button"
				           style="border: none; background: none; font-size: 1.5rem; position: absolute; top: 10px; right: 0px; line-height: 1; padding: 0 20px;"
				           aria-label="Close"
				           onclick="closeRevokebulkUPIVoucherModal()">
				       &times;
				   </button>
            </div>
			<div class="modal-body text-center">
			                <div class="otp-box-onboarding justify-content-center">
							
								<input  class="form-control form-control-sm test" type="password" id="password111" 
									oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\.*)\./g, '$1');"
							        name="password1" maxlength="1" autocomplete="off" onkeypress="focusNext(this)" onkeydown="focusBack()">
							        <input  class="form-control form-control-sm test" type="password" id="password222" 
									oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\.*)\./g, '$1');"
							        name="password2" maxlength="1" autocomplete="off" onkeypress="focusNext(this)" onkeydown="focusBack()">
							        <input  class="form-control form-control-sm test" type="password" id="password333" 
									oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\.*)\./g, '$1');"
							        name="password3" maxlength="1" autocomplete="off" onkeypress="focusNext(this)" onkeydown="focusBack()">
							        <input  class="form-control form-control-sm test" type="password" id="password444" 
									oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\.*)\./g, '$1');"
							        name="password4" maxlength="1" autocomplete="off" onkeypress="focusNext(this)" onkeydown="focusBack()">
							        <input  class="form-control form-control-sm test" type="password" id="password555" 
									oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\.*)\./g, '$1');"
							        name="password5" maxlength="1" autocomplete="off" onkeypress="focusNext(this)" onkeydown="focusBack()">
							        <input  class="form-control form-control-sm test" type="password" id="password666" 
									oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\.*)\./g, '$1');"
							        name="password6" maxlength="1" autocomplete="off" onkeydown="focusBack()">
							        <input  class="form-control form-control-sm test" type="hidden" id="orderId3" 
							        name="orderId3" >
									<div class="d-flex justify-content-center mt-2">
									    <i class="fa-solid fa-eye" id="toggleOtpIcon3" style="cursor: pointer;margin-top: 5px; " onclick="toggleOtpVisibility3()"></i>
									</div>
			                </div>
			               <label class="time-otp ml-0 text-dark" for="" id="countdown3" style="color: green;"></label>
						  <!-- <div class="text-center" id="countdown" style="color: green;"></div>-->
							<p id="resendCode3">Didn’t receive the code?  <a href="#" onclick="resendbulkrevokeVoucherOTP()">Resend OTP</a></p>
							<p class="error-msg" id="otpError3" style="color:red"></p>
			                    <p class="mb-0" id="maskedMobileDisplay3"></p>
			                </div>
			                <div class="d-flex justify-content-center mt-3">
								<button class="btn btn-primary w-100" id="authenticate3" onclick="bulkverfyrevokeVoucherOTP()">Authenticate</button>
			                </div>
			            </div>
			      
        </div>
    </div>
</div>


<!-- Modal UPI Voucher Revoked -->
<div class="customModal" id="revokeUPIVcAuthenticate">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content modal-bulk p-0">
            <div class="modal-top text-center">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <img src="img/modal-close.svg" alt="">
                </button>
                <img src="img/modal-success.svg" alt="">
            </div>
            <div class="modal-bottom">
                <span>UPI Voucher Revoked</span>
            </div>
        </div>
    </div>
</div>

<!-- Modal UPI Voucher Revoked -->
<div class="customModal" id="revokeUPIVcAuthenticateFail">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content modal-bulk p-0">
            <div class="modal-top text-center" >
				<!-- style="background-color: #F248221A !important;"-->
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <img src="img/modal-close.svg" alt="">
                </button>
                <img src="img/table-fail.svg" alt="">
            </div>
            <div class="modal-bottom">
                <span>UPI Voucher Revocation Failed</span>
            </div>
        </div>
    </div>
</div>

<!-- Modal UPI Voucher Revoked -->
<div class="customModal" id="smsUPIVcAuthenticate">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content modal-bulk p-0">
            <div class="modal-top text-center">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <img src="img/modal-close.svg" alt="">
                </button>
                <img src="img/modal-success.svg" alt="">
            </div>
            <div class="modal-bottom">
                <span>SMS Sent Successfully</span>
            </div>
        </div>
    </div>
</div>
<!-- Modal UPI Voucher Revoked -->
<div class="customModal" id="bulkrevokeSuccess">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content modal-bulk p-0">
            <div class="modal-top text-center">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <img src="img/modal-close.svg" alt="">
                </button>
                <img src="img/modal-success.svg" alt="">
            </div>
            <div class="modal-bottom">
                <span>Selected Vouchers Revoked Successfully</span>
            </div>
        </div>
    </div>
</div>

<!-- Modal UPI Voucher Revoked -->
<div class="customModal" id="smsUPIVcAuthenticateFail">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content modal-bulk p-0">
            <div class="modal-top text-center">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <img src="img/modal-close.svg" alt="">
                </button>
                <img src="img/modal-close.svg" alt="">
            </div>
            <div class="modal-bottom">
                <span>SMS could not be Send</span>
            </div>
        </div>
    </div>
</div>

<!-- Modal Explaining Voucher Issuance Statistics -->
<div class="customModal" id="explainvcIssuanceStatModal">
    <div class="modal-dialog modal-dialog-centered modal-approval-wrap modal-xl" role="document">
        <div class="modal-content modal-bulk text-left p-0">
            <div class="modal-header pb-0">
                <h5 class="modal-title w-100" id="exampleModalCenterTitle">Explaining Voucher Issuance Statistics</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <img src="img/modal-close.svg" alt="">
                </button>
            </div>
            <div class="modal-body">
                <p><i>Below is an explanation to each tile in the analytics dashboard. </i></p>
                <p>Sum of number of vouchers in A, B & C may not be equal to T, as partially redeemed vouchers are
                    counted twice. Amounts will always follow: T = A + B + C. Click Download to get a complete break-up
                    of the figures till date.</p>
                <div class="text-white modal-inn bg-black">
                    <h6>Total Vouchers Issued (A)</h6>
                    <p>All Vouchers Issued for the defined time period.</p>
                </div>

                <div class="text-dark modal-inn bg-grey">
                    <h6>Redeemed Vouchers (B)</h6>
                    <hr>
                    <p>Sum of the following:</p>
                    <ul>
                        <li>Exhausted Vouchers: Completely redeemed</li>
                        <li>Expired Vouchers: Partially redeemed</li>
                        <li>Active Vouchers: Partially redeemed</li>
                        <li>Revoked Vouchers: Partially redeemed</li>
                    </ul>
                </div>

                <div class="text-dark modal-inn bg-grey">
                    <h6>Revoked & Expired Vouchers (C)</h6>
                    <hr>
                    <p>Sum of the following:</p>
                    <ul>
                        <li>Expired Vouchers: Partially not redeemed</li>
                        <li>Revoked Vouchers: Partially not redeemed</li>
                        <li>Expired Vouchers: Completely not redeemed</li>
                        <li>Revoked Vouchers: Completely not redeemed</li>
                    </ul>
                </div>

                <div class="text-white modal-inn bg-green">
                    <h6>Active Vouchers (D) | D = A - B - C</h6>
                    <hr class="bg-white">
                    <p><b>Active Vouchers (D) = Total Vouchers Issued (A) - Redeemed Vouchers (B) - Revoked & Expired Vouchers (C)</b></p>
                    <p>Sum of the following:</p>
                    <ul>
                        <li>Active Vouchers: Issued and not redeemed</li>
                        <li>Active Vouchers: Issued and partially redeemed</li>
                    </ul>
                </div>


                <div class="d-flex justify-content-center mt-3">
                    <button class="btn btn-primary w-100" id="vcIssuanStatok">Close</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal -->
		<div id="confirmationDialog" style="display: none;">
			<div class="modal-dialog modal-dialog-centered modal-approval-wrap" role="document">
				            <div class="modal-content">
				                <div class="modal-header pb-0">
			                    <h5 class="modal-title" id="">Are you sure you want to revoke this? </h5>
			                    
			                </div>
				                <div class="modal-body confirmbox">
				                    <div class="d-flex justify-content-center mt-4">
										<button id="confirmButton">Yes</button>
										<button id="cancelButton">No</button>
			                    </div>
				                
				            </div>
				        </div>
			</div>
		</div>
		<!-- Slide-in Modal -->
		<!-- All inline styles replaced with unique CSS classes -->
		<div class="voucher-modal-overlay voucher-modal-overlay--dark" id="modal-overlay">
		  <div class="voucher-modal-canvas" id="bs-canvas-right1">
		    <div class="voucher-modal-scrollable-wrapper">
		      <div class="voucher-modal-scrollable">
		        <div class="voucher-header">
		          <h5 class="voucher-title">Voucher Details</h5>
		          <button class="voucher-close-btn bs-canvas-close" aria-label="Close">
		            <i class="fas fa-times voucher-close-icon"></i>
		          </button>
		        </div>

		        <div class="voucher-card">
		          <div class="voucher-card-header">
					<div class="voucher-card-icon-box">
					  <img id="voucherLogoImg" alt="Voucher Logo" width="24" height="24" style="display: none;">
					</div>
		            <div class="voucher-card-labels">
		              <div class="voucher-label-row">
		                <span class="voucher-label-title" id="voucherDesc">Meal</span>
		                <span class="voucher-label-title" id="voucherAmount">₹15,000</span>
		              </div>
		              <div class="voucher-label-row">
		                <span class="voucher-label-sub" id="redemtionType">Multiple</span>
		                <span class="voucher-label-sub">Voucher value</span>
		              </div>
		            </div>
		          </div>

		          <div class="voucher-status-box">
		            <span class="voucher-status-text" id="voucherStatus">Active</span>
		            <span class="voucher-status-text">Balance: <span class="voucher-balance" id="balanceAmount">₹5,000</span></span>
		          </div>

		          <div class="voucher-meta">
		            <div class="voucher-meta-row">
		              <span class="voucher-meta-label">Issue Date</span>
		              <span class="voucher-meta-label">Voucher ID</span>
		            </div>
		            <div class="voucher-meta-row">
		              <span class="voucher-meta-value" id="issueDate">25/10/2024</span>
		              <span class="voucher-meta-value" id="merchantTranId">ICICI00001145781</span>
		            </div>
		            <div class="voucher-meta-row">
		              <span class="voucher-meta-label">Beneficiary</span>
		              <span class="voucher-meta-label">Mobile Number</span>
		            </div>
		            <div class="voucher-meta-row">
		              <span class="voucher-meta-value" id="name">Ramesh Kumar</span>
		              <span class="voucher-meta-value"id="voucherMobile">9910318405</span>
		            </div>
		            <div class="voucher-meta-row">
		              <span class="voucher-meta-label">Bank A/c</span>
		              <span class="voucher-meta-label" >Expiry Date</span>
		            </div>
		            <div class="voucher-meta-row">
		              <span class="voucher-meta-value" id="accountNumber">
		                <!--<img src="img/indianbank.png" alt="indianbank" class="voucher-bank-icon">xxx0569-->
		              </span>
		              <span class="voucher-meta-value"id="expDate">25/10/2025</span>
		            </div>
		          </div>
		        </div>

		        <div class="voucher-redemption">
		          <h6 class="voucher-redemption-title">Redemption Details</h6>
		          <div class="voucher-redemption-card">
		            <div class="voucher-redemption-label" >Amount Spent</div>
		            <div class="voucher-redemption-values">
		              <div class="voucher-redemption-amount"id="amountSpent">₹10,000</div>
		              <!--<span class="voucher-status-pill">Partially Redeemed</span>-->
		            </div>
		          </div>
		        </div>

		        <ol class="voucher-transaction-list">
		          <div class="voucher-transaction-line"></div>
				  <!-- box1-->
		          <li class="voucher-transaction-item">
		            <div class="voucher-transaction-step">1</div>
		            <div class="voucher-transaction-card">
		              <div class="voucher-transaction-top">
		                <div>
		                  <div class="voucher-meta-label">Transaction date</div>
		                  <div class="voucher-meta-value">25/10/2024</div>
		                </div>
		                <div>
		                  <div class="voucher-meta-label">Transaction RRN</div>
		                  <div class="voucher-meta-value">ICICI00001145781</div>
		                </div>
		              </div>
		              <div class="voucher-transaction-bottom">
		                <div>
		                  <div class="voucher-meta-label">Merchant Name</div>
		                  <div class="voucher-meta-value">Ramesh Kumar</div>
		                </div>
		                <div>
		                  <div class="voucher-meta-label">Amount</div>
		                  <div class="voucher-meta-value">₹1,200</div>
		                </div>
		              </div>
		            </div>
		          </li>
				  <!-- box2-->
				  <li class="voucher-transaction-item">
		            <div class="voucher-transaction-step">2</div>
		            <div class="voucher-transaction-card">
		              <div class="voucher-transaction-top">
		                <div>
		                  <div class="voucher-meta-label">Transaction date</div>
		                  <div class="voucher-meta-value">25/10/2024</div>
		                </div>
		                <div>
		                  <div class="voucher-meta-label">Transaction RRN</div>
		                  <div class="voucher-meta-value">ICICI00001145781</div>
		                </div>
		              </div>
		              <div class="voucher-transaction-bottom">
		                <div>
		                  <div class="voucher-meta-label">Merchant Name</div>
		                  <div class="voucher-meta-value">Ramesh Kumar</div>
		                </div>
		                <div>
		                  <div class="voucher-meta-label">Amount</div>
		                  <div class="voucher-meta-value">₹1,200</div>
		                </div>
		              </div>
		            </div>
		          </li>
				  <!-- add as many box as wanted-->
		        </ol>
		      </div>
		    </div>

		    <div class="voucher-footer">
		      <button class="voucher-download-btn">
		        <i class="fas fa-download"></i>
		        Download History
		      </button>
		    </div>
		  </div>
		</div>
		<script>/*script for closing bulk revoke modal*/
			document.addEventListener('DOMContentLoaded', function () {
			    const cancelBtn = document.getElementById('bulkcancelbtn');
			    const modal = document.getElementById('bulkrevokeModal');

			    cancelBtn.addEventListener('click', function () {
			        modal.style.display = 'none';
			        modal.classList.remove('show');
			        document.body.classList.remove('modal-open');
			        const backdrop = document.querySelector('.modal-backdrop');
			        if (backdrop) backdrop.remove();

			        // Trigger clear filters
			        const clearFiltersBtn = document.getElementById('clearFilters');
			        if (clearFiltersBtn) {
			            clearFiltersBtn.click();
			        }

			        // Now call list limit function
			        //erupiVoucherCreateListLimit("AH");
			    });
			});

		</script>

		<script>/*quick filter*/
			document.addEventListener('DOMContentLoaded', function () {
			    const clearBtn = document.getElementById('clearFilters');
			    const tableBody = document.querySelector('#vouchersTableList tbody');
			    const dropdowns = {
			        quickFilters: document.getElementById('quickFilters')
			    };
			    const originalDropdownHTML = {
			        quickFilters: dropdowns.quickFilters.outerHTML
			    };
			    let originalRowsHTML = null;

			    function parseDate(dateStr) {
			        if (!dateStr || !dateStr.includes('-')) return null;
			        const [day, month, year] = dateStr.trim().split('-');
			        const parsed = new Date(`${year}-${month}-${day}`);
			        return isNaN(parsed.getTime()) ? null : parsed;
			    }

			    function setClearButtonState(enabled) {
			        clearBtn.style.cursor = enabled ? 'pointer' : 'not-allowed';
			        clearBtn.style.opacity = enabled ? '1' : '0.5';
			        clearBtn.dataset.enabled = enabled ? 'true' : 'false';
			    }

			    function filterRows(type) {
			        const rows = tableBody.querySelectorAll('tr');
			        if (!originalRowsHTML) originalRowsHTML = tableBody.innerHTML;

			        const today = new Date();
			        const todayStr = today.toDateString();
			        const month = today.getMonth();
			        const year = today.getFullYear();

			        rows.forEach(row => {
			            const issueDateText = row.cells[1]?.textContent.trim();
			            const statusText = row.cells[8]?.textContent.trim();
			            const issueDate = parseDate(issueDateText);
			            let show = false;

			            if (!issueDate) return row.style.display = 'none';

			            switch (type) {
			                case 'active':
			                    show = statusText === 'Active';
			                    break;
			                case 'expired-revoked':
			                    show = ['Expired', 'Revoked'].includes(statusText);
			                    break;
			                case 'issued-today':
			                    show = issueDate.toDateString() === todayStr;
			                    break;
			                case 'issued-this-month':
			                    show = issueDate.getMonth() === month && issueDate.getFullYear() === year;
			                    break;
			            }

			            row.style.display = show ? '' : 'none';
			        });

			        setClearButtonState(true);
			    }

			    document.body.addEventListener('click', function (e) {
			        const target = e.target;
			        if (!target.classList.contains('dropdown-item')) return;
			        e.preventDefault();

			        const map = {
			            'filter-active': ['quickFilters', 'Active'],
			            'filter-expired-revoked': ['quickFilters', 'Expired & Revoked'],
			            'filter-issued-today': ['quickFilters', 'Issued Today'],
			            'filter-issued-this-month': ['quickFilters', 'Issued this Month']
			        };

			        const idToType = {
			            'filter-active': 'active',
			            'filter-expired-revoked': 'expired-revoked',
			            'filter-issued-today': 'issued-today',
			            'filter-issued-this-month': 'issued-this-month'
			        };

			        const id = target.id;
			        if (!map[id]) return;

			        const [dropdownKey, label] = map[id];
			        const filterType = idToType[id];
			        filterRows(filterType);

			        const original = document.getElementById(dropdownKey);
			        const selectedDiv = document.createElement('div');
			        selectedDiv.id = dropdownKey;
			        selectedDiv.className = 'd-flex align-items-center';
			        selectedDiv.style.cssText = 'width: 190px; height: 44px; border-radius: 10px; padding: 10px; border: 1px solid #EDEDF0; font-size: 14px; color: #1F212C;';
			        selectedDiv.innerHTML = `<img src="img/filter-icon.svg" style="margin-right: 6px;">${label}`;

			        original.replaceWith(selectedDiv);
			    });

			    clearBtn.addEventListener('click', function () {
			        if (clearBtn.dataset.enabled !== 'true') return;

			        if (originalRowsHTML) {
			            tableBody.innerHTML = originalRowsHTML;
			        }

			        // Restore each original dropdown
			        for (const key in originalDropdownHTML) {
			            const container = document.getElementById(key);
			            if (container) {
			                container.outerHTML = originalDropdownHTML[key];
			            }
			        }
					// Reset date filter text
					   const dateFilterText = document.querySelector('.calender-time span');
					   if (dateFilterText) {
					       dateFilterText.textContent = 'Select Time Period';
					   }

			        setClearButtonState(false);
					// erupiVoucherCreateListLimit(timePeriod = "AH")
			    });
			});

		</script>



		<script>
		/*document.addEventListener('DOMContentLoaded', function () {
		    const tabLinks = document.querySelectorAll('#dashboardTabs .nav-link');
		    const downloadBtnContainer = document.querySelector('.download-btn-container');

		    function showOrHideButtons() {
		        const activeTab = document.querySelector('#dashboardTabs .nav-link.active');
		        const tabTarget = activeTab?.getAttribute('href');

		        if (tabTarget === '#vouchers') {
		            downloadBtnContainer.style.display = '';
		        } else {
		            downloadBtnContainer.style.display = 'none';
		        }
		    }

		    // Initial check on load
		    showOrHideButtons();

		    // Attach click listeners (fallback if Bootstrap events fail)
		    tabLinks.forEach(tab => {
		        tab.addEventListener('click', () => {
		            // Give tab switch time to apply .active class
		            setTimeout(showOrHideButtons, 10);
		        });
		    });
		});*/
		</script>




		
		<!-- Modal Script -->
		<script>
		  document.querySelectorAll('.view-voucher-details').forEach(btn => {
		    btn.addEventListener('click', function () {
		      document.getElementById('bs-canvas-right1').style.right = '0';
		      document.getElementById('modal-overlay').style.display = 'block';
		    });
		  });

		  document.querySelector('.bs-canvas-close').addEventListener('click', function () {
		    document.getElementById('bs-canvas-right1').style.right = '-378px';
		    document.getElementById('modal-overlay').style.display = 'none';
		  });

		  document.getElementById('modal-overlay').addEventListener('click', function (e) {
		    if (e.target.id === 'modal-overlay') {
		      document.getElementById('bs-canvas-right1').style.right = '-378px';
		      this.style.display = 'none';
		    }
		  });
		</script>

